<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Futuristic Solar Project Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');

body {
    font-family: 'Orbitron', sans-serif;
    background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
    color: #fff;
    margin: 0;
    padding: 0;
}
h1 {
    text-align: center;
    margin: 20px 0;
    font-size: 2.5em;
    color: #00ffea;
    text-shadow: 0 0 20px #00ffea, 0 0 30px #00ffea;
}
h2, h3, summary {
    color: #00ffea;
    text-shadow: 0 0 10px #00ffea;
}
.container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    padding: 20px;
    gap: 20px;
}
.card {
    background: rgba(0, 255, 234, 0.05);
    border: 2px solid rgba(0, 255, 234, 0.3);
    border-radius: 15px;
    padding: 20px;
    box-shadow: 0 0 20px rgba(0, 255, 234, 0.3);
    transition: transform 0.3s, box-shadow 0.3s;
    backdrop-filter: blur(5px);
}
.card:hover {
    transform: translateY(-5px);
    box-shadow: 0 0 30px rgba(0, 255, 234, 0.6);
}
label {
    display: block;
    margin: 10px 0 5px;
    font-size: 0.9em;
    opacity: 0.8;
}
input, textarea, select {
    width: 100%;
    box-sizing: border-box;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid rgba(0, 255, 234, 0.5);
    background-color: rgba(15, 32, 39, 0.8);
    color: #00ffea;
    margin-bottom: 10px;
    font-family: 'Orbitron', sans-serif;
}
button {
    background: #00ffea;
    color: #000;
    border: none;
    padding: 12px 20px;
    cursor: pointer;
    border-radius: 10px;
    font-weight: bold;
    margin-top: 10px;
    width: 100%;
    transition: all 0.3s;
}
button:hover {
    background: #fff;
    color: #000;
    transform: scale(1.05);
    box-shadow: 0 0 20px #00ffea;
}
.progress-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 15px;
    margin-top: 20px;
}
.progress-card {
    background: rgba(0,0,0,0.3);
    border: 2px solid rgba(0,255,234,0.3);
    border-radius: 10px;
    padding: 15px;
    text-align: center;
}
.progress-bar {
    width: 100%;
    height: 10px;
    border-radius: 5px;
    background: rgba(255,255,255,0.1);
    margin-top: 10px;
    overflow: hidden;
}
.progress-fill {
    height: 100%;
    border-radius: 10px;
    background: linear-gradient(90deg, #00ffea, #00ffaa);
    width: 0%;
    transition: width 0.5s ease-in-out;
}
.activity-list {
    margin-top: 10px;
    max-height: 150px;
    overflow-y: auto;
}
.activity-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
    background: rgba(15, 32, 39, 0.9);
    padding: 8px 12px;
    border-radius: 8px;
}
.delete-btn {
    background: #ff3c6a55;
    color: #ffc0d5;
    width: auto;
    padding: 4px 10px;
    font-size: 0.8em;
    margin: 0;
}
.master-item-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
canvas {
    background: rgba(0,0,0,0.2);
    border-radius: 15px;
    margin-top: 15px;
}
footer {
    text-align: center;
    padding: 20px;
    margin-top: 20px;
    font-size: 0.8em;
    color: #fff;
    opacity: 0.5;
}

input[type=range] {
  -webkit-appearance: none;
  width: 100%;
  background: transparent;
}
input[type=range]::-webkit-slider-thumb {
  -webkit-appearance: none;
  height: 16px;
  width: 16px;
  border-radius: 50%;
  background: #00ffea;
  cursor: pointer;
  margin-top: -6px;
  box-shadow: 0 0 10px #00ffea;
}
input[type=range]::-moz-range-thumb {
  height: 16px;
  width: 16px;
  border-radius: 50%;
  background: #00ffea;
  cursor: pointer;
  box-shadow: 0 0 10px #00ffea;
}
input[type=range]::-webkit-slider-runnable-track {
  width: 100%;
  height: 4px;
  cursor: pointer;
  background: rgba(0, 255, 234, 0.3);
  border-radius: 5px;
}
input[type=range]::-moz-range-track {
  width: 100%;
  height: 4px;
  cursor: pointer;
  background: rgba(0, 255, 234, 0.3);
  border-radius: 5px;
}
</style>
<!-- Chosen Palette: Futuristic Teal/Cyan -->
<!-- Application Structure Plan: The dashboard is organized into two main interactive cards: 1) A 'Project Control' card for all data inputs, logically grouped into collapsible sections for project info, master scope, and quality metrics. 2) A 'Live Dashboard' card that provides an immediate visual summary of all inputs through charts and a detailed progress grid. This structure creates a clean and efficient workflow where data entry on one side instantly and automatically updates the visualizations on the other. The application is driven by a unified JavaScript `state` object that persists in localStorage, making it a reactive and reusable tool. -->
<!-- Visualization & Content Choices: 
    1. Overall Completion -> Goal: Show a multi-faceted view of project progress. -> Viz: Radar Chart -> Interaction: Updates automatically as progress data is entered. -> Justification: A radar chart is ideal for a futuristic theme and provides a much richer view than a single percentage, allowing for quick comparison of progress across different project areas like civil, mechanical, and electrical works.
    2. Quality Index -> Goal: Display a single, critical metric for project quality. -> Viz: Gauge Chart (simulated with a doughnut chart) -> Interaction: The gauge updates based on a weighted formula. -> Justification: A gauge provides an immediate and universally understood "health" reading, making the Quality Index a high-impact focal point.
    3. Component Progress -> Goal: Provide a detailed, granular view of every project item. -> Presentation: A grid of animated progress bars. -> Justification: This gives project managers the detailed component-level view they need, complementing the high-level charts. The animation adds to the futuristic feel and visual feedback. -->
<!-- CONFIRMATION: NO SVG used. NO Mermaid JS used. -->
</head>
<body>

<h1 id="mainTitle">Futuristic Solar Dashboard</h1>

<div class="container">
    <div class="card">
        <h2>Project Control</h2>
        
        <details open>
            <summary class="text-lg text-cyan-300 cursor-pointer">Project Info</summary>
            <div class="p-2">
                <label>Project Name</label>
                <input type="text" id="projectName" class="project-detail-input">
                <label>Site Engineer</label>
                <input type="text" id="siteEngineer" class="project-detail-input">
                <label>Lead Engineer</label>
                <input type="text" id="leadEngineer" class="project-detail-input">
            </div>
        </details>

        <details open>
            <summary class="text-lg text-cyan-300 cursor-pointer mt-4">Master Scope & Progress</summary>
            <div id="masterDataInputs" class="grid grid-cols-1 md:grid-cols-2 gap-x-4 p-2"></div>
        </details>
        
        <details>
            <summary class="text-lg text-cyan-300 cursor-pointer mt-4">Customize Master Scope</summary>
            <div class="p-2">
                <div class="grid grid-cols-3 gap-x-4">
                    <input type="text" id="newMasterName" placeholder="Activity Name" class="col-span-3 sm:col-span-1">
                    <input type="number" id="newMasterTotal" placeholder="Total Scope" class="col-span-3 sm:col-span-1">
                    <input type="number" id="newMasterCompleted" placeholder="Completed" class="col-span-3 sm:col-span-1">
                </div>
                <button id="addMasterActivityBtn">Add Master Activity</button>
            </div>
        </details>

        <details>
            <summary class="text-lg text-cyan-300 cursor-pointer mt-4">Quality Metrics</summary>
            <div id="qualityInputs" class="grid grid-cols-1 p-2"></div>
        </details>

        <details>
            <summary class="text-lg text-cyan-300 cursor-pointer mt-4">Other Activities</summary>
             <div class="grid grid-cols-3 gap-x-4 p-2">
                <input type="text" id="otherActivityName" placeholder="Activity Name" class="col-span-3 sm:col-span-1">
                <input type="number" id="otherActivityTotal" placeholder="Total Qty" class="col-span-3 sm:col-span-1">
                <input type="number" id="otherActivityCompleted" placeholder="Completed Qty" class="col-span-3 sm:col-span-1">
            </div>
            <button id="addOtherActivityBtn">Add Other Activity</button>
            <div class="activity-list" id="activityList"></div>
        </details>

         <details>
            <summary class="text-lg text-cyan-300 cursor-pointer mt-4">Notes / Remarks</summary>
            <div class="p-2">
                <textarea id="notes" class="project-detail-input" rows="4" placeholder="Enter daily notes or remarks here..."></textarea>
            </div>
        </details>
        
        <div class="grid grid-cols-2 gap-4 mt-6">
            <button id="importExcelBtn">Import from Excel</button>
            <button id="downloadExcelBtn">Download Excel Report</button>
        </div>
        <input type="file" id="importExcelInput" class="hidden" accept=".xlsx, .xls">
    </div>

    <div class="card">
        <h2>Live Dashboard</h2>
        <div class="text-center my-4">
            <h3 class="text-xl">Overall Project Completion</h3>
            <p id="overallCompletionPercentage" class="text-4xl font-bold text-cyan-300">0%</p>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
            <canvas id="completionChart" height="250"></canvas>
            <canvas id="qualityChart" height="250"></canvas>
        </div>
        <h3 class="mt-6 text-center">Component Progress</h3>
        <div class="progress-grid" id="componentGrid"></div>
    </div>
</div>

<footer>
    <p>© 2025 <span id="footerProjectName">Futuristic Solar Project</span>. All Rights Reserved.</p>
    <p>This site and its content are registered. Unauthorized duplication or distribution is strictly prohibited.</p>
    <p class="mt-2" id="footerTimestamp">Hyderabad, Telangana, India | 11:56 AM, Friday, September 26, 2025</p>
</footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
    let state = {
        projectDetails: {
            projectName: 'Futuristic Solar Project',
            siteEngineer: '',
            leadEngineer: '',
            notes: ''
        },
        masterData: [
            { name: 'MW AC', total: 10, completed: 10 },
            { name: 'MW DC', total: 12, completed: 12 },
            { name: 'Cable (km)', total: 50, completed: 5 },
            { name: 'Earthing', total: 200, completed: 20 },
            { name: 'Piles', total: 5000, completed: 500 },
            { name: 'LA', total: 150, completed: 15 },
            { name: 'Roads (m)', total: 1000, completed: 100 },
            { name: 'MMS', total: 2500, completed: 250 },
            { name: 'Modules', total: 20000, completed: 2000 },
            { name: 'Fencing (m)', total: 2000, completed: 200 },
        ],
        qualityInputs: { ftrq: 100, ncr: 0, obsComp: 100 },
        otherActivities: []
    };

    let completionChart, qualityChart;

    function saveState() {
        localStorage.setItem('futuristicSolarDashboardState', JSON.stringify(state));
    }

    function loadState() {
        const savedState = localStorage.getItem('futuristicSolarDashboardState');
        if (savedState) {
            state = JSON.parse(savedState);
        }
    }

    function render() {
        renderProjectDetails();
        renderMasterDataInputs();
        renderQualityInputs();
        renderActivityList();
        renderComponentGrid();
        renderOverallCompletion();
        updateCharts();
        saveState();
    }
    
    function renderProjectDetails() {
        document.getElementById('projectName').value = state.projectDetails.projectName;
        document.getElementById('siteEngineer').value = state.projectDetails.siteEngineer;
        document.getElementById('leadEngineer').value = state.projectDetails.leadEngineer;
        document.getElementById('notes').value = state.projectDetails.notes;
        const projectName = state.projectDetails.projectName || 'Futuristic Solar Dashboard';
        document.getElementById('mainTitle').textContent = projectName;
        document.getElementById('footerProjectName').textContent = projectName;
    }

    function renderMasterDataInputs() {
        const container = document.getElementById('masterDataInputs');
        container.innerHTML = state.masterData.map((item, index) => `
            <div>
                <div class="master-item-header">
                    <label>${item.name}:</label>
                    <button class="delete-btn" data-index="${index}" data-type="master">✖</button>
                </div>
                <div class="grid grid-cols-2 gap-2">
                    <input type="number" data-index="${index}" data-type="total" placeholder="Total" value="${item.total || ''}" class="data-input">
                    <input type="number" data-index="${index}" data-type="completed" placeholder="Completed" value="${item.completed || ''}" class="data-input-number">
                </div>
                <input type="range" data-index="${index}" data-type="completed" value="${item.completed || 0}" max="${item.total || 0}" class="data-input-range mt-1">
            </div>
        `).join('');
    }
    
    function renderQualityInputs() {
        const container = document.getElementById('qualityInputs');
        container.innerHTML = `
            <div>
                <label>FTRQ (%): ${state.qualityInputs.ftrq}%</label>
                <input type="range" id="ftrq" value="${state.qualityInputs.ftrq}" max="100" class="quality-input">
            </div>
            <div>
                <label>NCR Count:</label>
                <input type="number" id="ncr" value="${state.qualityInputs.ncr}" class="quality-input">
            </div>
            <div>
                <label>Observation Completion (%): ${state.qualityInputs.obsComp}%</label>
                <input type="range" id="obsComp" value="${state.qualityInputs.obsComp}" max="100" class="quality-input">
            </div>
        `;
    }
    
    function renderActivityList() {
        const list = document.getElementById('activityList');
        list.innerHTML = state.otherActivities.map((a, i) => `
            <div class="activity-item">
                <span>${a.name} (${a.completed}/${a.total})</span>
                <button class="delete-btn" data-index="${i}" data-type="other">✖</button>
            </div>
        `).join('');
    }

    function renderComponentGrid() {
        const grid = document.getElementById('componentGrid');
        const allElements = [...state.masterData, ...state.otherActivities];
        grid.innerHTML = allElements.map(item => {
            const percent = Math.min(((item.completed / item.total) * 100) || 0, 100);
            return `
                <div class="progress-card">
                    <strong>${item.name}</strong>
                    <div class="progress-bar"><div class="progress-fill" style="width:${percent}%"></div></div>
                    <small>${percent.toFixed(1)}%</small>
                </div>
            `;
        }).join('');
    }

    function calculateOverallCompletion() {
        const allItems = [...state.masterData, ...state.otherActivities].filter(item => item.total > 0);
        if (allItems.length === 0) return 0;
        const percentages = allItems.map(item => (item.completed / item.total) * 100);
        const averageCompletion = percentages.reduce((sum, p) => sum + p, 0) / allItems.length;
        return averageCompletion;
    }

    function renderOverallCompletion() {
        const percentage = calculateOverallCompletion();
        document.getElementById('overallCompletionPercentage').textContent = `${percentage.toFixed(2)}%`;
    }
    
    function calculateQualityIndex() {
        const { ftrq, ncr, obsComp } = state.qualityInputs;
        const maxNCR = 10;
        const ncrScore = Math.max(0, (1 - ncr / maxNCR) * 100);
        return Math.round((ftrq * 0.5) + (ncrScore * 0.3) + (obsComp * 0.2));
    }

    function updateCharts() {
        const allElements = [...state.masterData, ...state.otherActivities].filter(e => e.total > 0);
        const labels = allElements.map(e => e.name);
        const completionData = allElements.map(e => (e.completed / e.total * 100) || 0);
        const qualityIndex = calculateQualityIndex();

        const chartOptions = {
            plugins: { legend: { labels: { color: '#e0e0e0', font: { family: 'Orbitron' } } }, title: { display: true, color: '#00ffea', font: { size: 16, family: 'Orbitron' } } },
            scales: { r: { angleLines: { color: '#00ffea44' }, grid: { color: '#00ffea44' }, pointLabels: { color: '#e0e0e0', font: { size: 10, family: 'Orbitron' } }, ticks: { backdropColor: '#0f2027', color: '#e0e0e0' } } }
        };

        if (completionChart) completionChart.destroy();
        completionChart = new Chart(document.getElementById('completionChart').getContext('2d'), {
            type: 'radar',
            data: { labels, datasets: [{ label: 'Completion %', data: completionData, backgroundColor: '#00ffea33', borderColor: '#00ffea', pointBackgroundColor: '#00ffea' }] },
            options: { ...chartOptions, plugins: { ...chartOptions.plugins, title: { ...chartOptions.plugins.title, text: 'Site Completion by Area' } } }
        });

        if (qualityChart) qualityChart.destroy();
        qualityChart = new Chart(document.getElementById('qualityChart').getContext('2d'), {
            type: 'doughnut',
            data: { labels: ['Quality Index', ''], datasets: [{ data: [qualityIndex, 100 - qualityIndex], backgroundColor: [`hsl(${qualityIndex * 1.2}, 80%, 50%)`, '#333'], borderColor: '#0f2027', borderWidth: 4 }] },
            options: {
                cutout: '70%', rotation: -90, circumference: 180,
                plugins: { ...chartOptions.plugins, title: { ...chartOptions.plugins.title, text: `Quality Index: ${qualityIndex}%` }, legend: { display: false } }
            }
        });
    }

    function handleExcelUpload(event) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = (e) => {
            try {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });

                const infoSheet = workbook.Sheets['Project Info'];
                if (infoSheet) {
                    const infoData = XLSX.utils.sheet_to_json(infoSheet);
                    infoData.forEach(row => {
                        if (row.Key === 'Project Name') state.projectDetails.projectName = row.Value;
                        if (row.Key === 'Site Engineer') state.projectDetails.siteEngineer = row.Value;
                        if (row.Key === 'Lead Engineer') state.projectDetails.leadEngineer = row.Value;
                        if (row.Key === 'Notes') state.projectDetails.notes = row.Value;
                    });
                }

                const masterSheet = workbook.Sheets['Master Data'];
                if (masterSheet) {
                    const masterData = XLSX.utils.sheet_to_json(masterSheet);
                    masterData.forEach(row => {
                        const item = state.masterData.find(d => d.name === row.Item);
                        if (item) {
                            item.total = parseFloat(row.Total) || 0;
                            item.completed = parseFloat(row.Completed) || 0;
                        } else {
                            state.masterData.push({ name: row.Item, total: parseFloat(row.Total) || 0, completed: parseFloat(row.Completed) || 0 });
                        }
                    });
                }

                const otherSheet = workbook.Sheets['Other Activities'];
                if (otherSheet) {
                    state.otherActivities = XLSX.utils.sheet_to_json(otherSheet).map(row => ({
                        name: row.Activity,
                        total: parseFloat(row.Total) || 0,
                        completed: parseFloat(row.Completed) || 0,
                    }));
                }
                
                const qualitySheet = workbook.Sheets['Quality Summary'];
                if (qualitySheet) {
                    const qualityData = XLSX.utils.sheet_to_json(qualitySheet)[0];
                    if (qualityData) {
                        state.qualityInputs.ftrq = parseFloat(qualityData.ftrq) || 100;
                        state.qualityInputs.ncr = parseFloat(qualityData.ncr) || 0;
                        state.qualityInputs.obsComp = parseFloat(qualityData.obsComp) || 100;
                    }
                }
                
                render();
                alert('Dashboard updated successfully from Excel!');
            } catch (error) {
                console.error("Error processing Excel file:", error);
                alert("Could not process the Excel file. Please ensure it is in the correct format.");
            }
        };
        reader.readAsArrayBuffer(file);
        event.target.value = '';
    }

    document.getElementById('addMasterActivityBtn').addEventListener('click', () => {
        const name = document.getElementById('newMasterName').value;
        const total = parseFloat(document.getElementById('newMasterTotal').value) || 0;
        const completed = parseFloat(document.getElementById('newMasterCompleted').value) || 0;
        if (name && total > 0) {
            state.masterData.push({ name, total, completed });
            document.getElementById('newMasterName').value = '';
            document.getElementById('newMasterTotal').value = '';
            document.getElementById('newMasterCompleted').value = '';
            render();
        }
    });

    document.getElementById('addOtherActivityBtn').addEventListener('click', () => {
        const name = document.getElementById('otherActivityName').value;
        const total = parseFloat(document.getElementById('otherActivityTotal').value) || 0;
        const completed = parseFloat(document.getElementById('otherActivityCompleted').value) || 0;
        if (name && total > 0) {
            state.otherActivities.push({ name, total, completed });
            document.getElementById('otherActivityName').value = '';
            document.getElementById('otherActivityTotal').value = '';
            document.getElementById('otherActivityCompleted').value = '';
            render();
        }
    });

    document.querySelector('.container').addEventListener('input', (e) => {
        if (e.target.matches('.data-input, .data-input-number, .data-input-range')) {
            const index = parseInt(e.target.dataset.index);
            const type = e.target.dataset.type;
            const value = parseFloat(e.target.value) || 0;
            state.masterData[index][type] = value;
            render();
        }
        if (e.target.matches('.quality-input')) {
            state.qualityInputs[e.target.id] = parseFloat(e.target.value) || 0;
            render();
        }
        if (e.target.matches('.project-detail-input')) {
            state.projectDetails[e.target.id] = e.target.value;
            render();
        }
    });
    
    document.querySelector('.container').addEventListener('click', (e) => {
        if(e.target.classList.contains('delete-btn')) {
            const index = parseInt(e.target.dataset.index);
            const type = e.target.dataset.type;
            if (type === 'master') {
                state.masterData.splice(index, 1);
            } else if (type === 'other') {
                state.otherActivities.splice(index, 1);
            }
            render();
        }
    });
    
    document.getElementById('downloadExcelBtn').addEventListener('click', () => {
        const wb = XLSX.utils.book_new();
        const projectInfo = [
            { Key: "Project Name", Value: state.projectDetails.projectName },
            { Key: "Site Engineer", Value: state.projectDetails.siteEngineer },
            { Key: "Lead Engineer", Value: state.projectDetails.leadEngineer },
            { Key: "Notes", Value: state.projectDetails.notes }
        ];
        const wsInfo = XLSX.utils.json_to_sheet(projectInfo);
        XLSX.utils.book_append_sheet(wb, wsInfo, "Project Info");

        const masterExport = state.masterData.map(d => ({ Item: d.name, Total: d.total, Completed: d.completed, 'Completion %': ((d.completed / d.total) * 100 || 0).toFixed(1) }));
        const ws1 = XLSX.utils.json_to_sheet(masterExport);
        XLSX.utils.book_append_sheet(wb, ws1, "Master Data");
        
        if (state.otherActivities.length > 0) {
            const otherExport = state.otherActivities.map(d => ({ Activity: d.name, Total: d.total, Completed: d.completed, 'Completion %': ((d.completed / d.total) * 100 || 0).toFixed(1) }));
            const ws2 = XLSX.utils.json_to_sheet(otherExport);
            XLSX.utils.book_append_sheet(wb, ws2, "Other Activities");
        }
        
        const qualityExport = [{ 'Quality Index': calculateQualityIndex() + '%', ...state.qualityInputs }];
        const ws3 = XLSX.utils.json_to_sheet(qualityExport);
        XLSX.utils.book_append_sheet(wb, ws3, "Quality Summary");

        XLSX.writeFile(wb, `${state.projectDetails.projectName || 'Solar_Project'}_Dashboard.xlsx`);
    });

    document.getElementById('importExcelBtn').addEventListener('click', () => {
        document.getElementById('importExcelInput').click();
    });
    document.getElementById('importExcelInput').addEventListener('change', handleExcelUpload);

    loadState();
    render();
});
</script>

</body>
</html>

